<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
	<title>Business Publisher</title>	
	<link rel="STYLESHEET" type="text/css" href="styles.css">
	<script src="properties.js"></script>
	<script src="zoom.js"></script>
	<script src='helper.js'></script>
		
<script language="JavaScript">

var selectedLangTag = "en";

isIE=document.all;
isNN=!document.all&&document.getElementById;
isN4=document.layers;


function Print() {
	
	if ((parent.data.document.getElementById("printFunctions")  != "undefined") && (parent.data.document.getElementById("printFunctions") != null)) {
		var constPageHeight = 842;
		var constPageWidth = 595;
		var constDoubleMargin = 136;
		var constFullPageHeight = constPageHeight + constDoubleMargin;
		var constFullPageWidth = constPageWidth  + 54;
		
		var modelId = parent.data.getZoomManager().id;

		
		var zoom = parent.data.getZoomManager();
		var zoomFactor = zoom.getZoomValue();

		
		var imageHeight = parent.data.document.getElementById(modelId).height;
		var imageWidth = parent.data.document.getElementById(modelId).width;
		var heightSteps = Math.ceil(imageHeight/constPageHeight);
		var widthSteps = Math.ceil(imageWidth/constPageWidth);
		var constFullPageHeightStep = constFullPageHeight * heightSteps;
		var i = 0;
		var j = 0;
		
		var div = parent.data.document.getElementById('print');

		var hCorr = constFullPageHeight/imageHeight;
		var wCorr = constFullPageWidth/imageWidth;
		
		if ((imageHeight <= constPageHeight) && (imageWidth <= constPageWidth)) {
				var p = parent.data.document.createElement('p');
				p.innerHTML = '<img id=\"'+modelId+'\"src=\"'+modelId+'_'+zoomFactor+'.png\" style=\"width='+imageWidth+'; height='+imageHeight+';\"></img>';		
				div.appendChild(p);
			}
		
		else {	
			while(i < widthSteps) {
				while(j < heightSteps) {
					var p = parent.data.document.createElement('p');
					if (isIE) {
						p.style.setAttribute('position', 'static');
						p.style.setAttribute('page-break-after', '');
					}
					else {
						p.setAttribute('style', 'position:static');
						p.setAttribute('style', "page-break-after:''");
					}
					p.innerHTML = '<img id=\"'+modelId+'\"src=\"'+modelId+'_'+zoomFactor+'.png\" style=\"position:absolute; top:'+i*constFullPageHeightStep+' px; left:-'+i*constFullPageWidth+' px; overflow:hidden;clip:rect('+j*constPageHeight+' px,  '+(i+1)*constFullPageWidth +' px,  '+(j+1)*constPageHeight+' px,  '+i*constFullPageWidth+' px )\"></img>';		
					div.appendChild(p);
					j=j+1;
					
				}
				j=0;
				i=i+1;
			}
		}

			
		top.data.focus();
		window.print();
	}
	
}

	
function WinOpen()
{
	newwin=window.open(parent.data.location.href,"","scrollbars")
	if (document.all)
	{
		newwin.moveTo(0,0)
		newwin.resizeTo(screen.width,screen.height)
	}
	else
	{
		newwin.moveTo(0,0)
		newwin.resizeTo(screen.width,screen.height)
	}
}
	
var JS_Array_File = new Array();
var JS_Array_Name = new Array();
var JsTargetModel = "model";
var JsUsed = 0;
var JsAct  = -1

function JS_History_Initialize() {
	document.frm.cbo.options.length=1;
}

function JS_History_GoBack() {
	if(JsAct > 0) {
		document.frm.cbo.options.selectedIndex -= 1;
		JS_History_Jump();
	}
}

function JS_History_GoForward() {
	if(JsAct < (JsUsed-1)) {
		document.frm.cbo.options.selectedIndex += 1;
		JS_History_Jump();
	}
}

function JS_History_AddModel(JsModName, JsModFile) {
var pos=-1;
var x=0;
	for(x=0; x<JsUsed; x++) {
		if(JS_Array_Name[x]==JsModName) { pos=x;}
	}
	if(pos==-1) {	//nichts gefunden =>hinzufuegen nach aktueller Position
		JsAct=JsAct+1;
		JS_Array_Name[JsAct]=JsModName;
		JS_Array_File[JsAct]=JsModFile;
		JsUsed = JsAct+1;
		if (document.frm.cbo.length < JsUsed) {
			document.frm.cbo.length = JsUsed;
		}
		document.frm.cbo.options[JsAct] =  new Option(JsModName);
	}
	else {
		JsAct=pos;
	}
	document.frm.cbo.selectedIndex = JsAct;
	document.frm.cbo.length = JsUsed;
}

function JS_History_Jump() {
	JsAct = document.frm.cbo.options.selectedIndex;
	parent.frames[JsTargetModel].location.href = JS_Array_File[JsAct];

}

function ZoomOut() {
	if ((parent.data.document.getElementById("zoomFunctions")  != "undefined") && (parent.data.document.getElementById("zoomFunctions") != null)) {
		parent.data.getZoomManager().zoomOut();
	}
}

function ZoomIn() {
	if ((parent.data.document.getElementById("zoomFunctions")  != "undefined") && (parent.data.document.getElementById("zoomFunctions") != null)) {
		parent.data.getZoomManager().zoomIn();
	}
}

function ZoomOrig() {
	if ((parent.data.document.getElementById("zoomFunctions")  != "undefined") && (parent.data.document.getElementById("zoomFunctions") != null)) {
		parent.data.getZoomManager().zoomOrig();
	}
}

</script>
	
</head>

<body class="nav" onLoad="javascript: JS_History_Initialize(); return true;">


<table style="width:100%;border-collapse:collapse;"><tr><td style="width:370px">

<div id="buttons" class="buttons"  >

<a href="mod_idx.htm" target="info">
<script>document.write('<img src="images/mod_inx.gif" title="' + properties[selectedLangTag]['wp_mod_inx'] + '" />');</script>
</a>
<a href="mod_list.htm" target="info" ><script>document.write('<img src="images/mod_list.gif" title="' + properties[selectedLangTag]['wp_mod_list'] + '" />');</script></a>
<a href="obj_idx.htm" target="info" ><script>document.write('<img src="images/obj_inx.gif" title="' + properties[selectedLangTag]['wp_obj_inx'] + '" />');</script></a>
<a href="obj_list.htm" target="info" ><script>document.write('<img src="images/obj_list.gif" title="' + properties[selectedLangTag]['wp_obj_list'] + '" />');</script></a>
<a href="javascript: Print();"><script>document.write('<img src="images/print.gif" title="' + properties[selectedLangTag]['wp_print'] + '" />');</script></a>
<a href="javascript: WinOpen();"><script>document.write('<img src="images/full_n.gif" title="' + properties[selectedLangTag]['wp_full_n'] + '" />');</script></a>
<a href="javascript: ZoomIn();" target=""><script>document.write('<img src="images/mini_zoomin.gif" title="' + properties[selectedLangTag]['wp_mini_zoomin'] + '" />');</script></a>
<a href="javascript: ZoomOut();" target=""><script>document.write('<img src="images/mini_zoomout.gif" title="' + properties[selectedLangTag]['wp_mini_zoomout'] + '" />');</script></a>
<a href="javascript: ZoomOrig();" target=""><script>document.write('<img src="images/mini_zoomhund.gif" title="' + properties[selectedLangTag]['wp_mini_zoomhund'] + '" />');</script></a>

</div>
</td><td style="width:auto;">
<div id="auswahl" class="buttons"><font face="Arial"><table><form name="frm"><td valign="middle">
<a href="#" onClick="javascript: JS_History_GoBack(); return false;"><script>document.write('<img src="images/previouspage.gif" title="' + properties[selectedLangTag]['wp_previouspage'] + '" />');</script></a></td><td valign="middle">
			<select name="cbo" onChange="javascript: JS_History_Jump(); return false;" style="width:200px;">
			<option selected>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</option>
			<option>&nbsp;</option>
			<option>&nbsp;</option>
			<option>&nbsp;</option></select></td><td valign="middle">
<a href="#" onClick="javascript: JS_History_GoForward(); return false;"><script>document.write('<img src="images/nextpage.gif" title="' + properties[selectedLangTag]['wp_nextpage'] + '" />');</script></a></td></form></table></font></div>
</td><td style="width:25px;">
<div id="help" class="buttons">
	<ARIS LINK_HELP><a href="help.htm" target="<ARIS TARGET_HELP>"><script>document.write('<img src="images/help.gif" title="' + properties[selectedLangTag]['wp_help'] + '" />');</script></a></ARIS LINK_HELP></div>

</td></tr></table>

</body>
</html>
