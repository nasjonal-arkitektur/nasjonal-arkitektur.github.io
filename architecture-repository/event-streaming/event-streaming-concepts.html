<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Publisering av hendelser :: Nasjonalt arkitekturverksted (ny versjon under etablering des. 2020)</title>
    <link rel="canonical" href="https://digdir.gitlab.io/site/architecture-repository/event-streaming/event-streaming-concepts.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://digdir.gitlab.io/site">Nasjonalt arkitekturverksted (ny versjon under etablering des. 2020)</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Valg</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Rolle</a>
            <a class="navbar-item" href="#">Preferanser</a>
            <a class="navbar-item" href="#">Språk</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Ressurser</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Verktøy</a>
            <a class="navbar-item" href="#">Kunnskapsbibliotek</a>
          </div>
        </div>	
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Hjelp</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Om NEAR-NO</a>
            <a class="navbar-item" href="#">FAQ</a>
          </div>
        </div>
		<a id="twitter-link" class="navbar-item" href="https://twitter.com/janakaSteph" target="_blank">
          <i class="fab fa-twitter"></i>
        </a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="architecture-repository" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Nasjonalt arkitekturverksted</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Om Nasjonalt arkitekturverksted</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Praktiske tips om bruk av arkitekturverkstedet</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reading-guide/module-reading-guide.html">Leseveiledning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Praktiske tips om bruk av git-verktøy</span>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../antora/module-antora.html">Praktiske tips om innholdsproduksjon og publisering med Antora og Asciidoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../archi/module-archi.html">Praktiske tips om arkitekturmodellering og samarbeid i Archi</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../archi/module-archi.html">Praktiske tips om utveksling av arkitekturmodeller</a>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Hvordan gi kommentarer og få svar på spørsmål</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../about-topic-areas/about-topic-areas.html">Temaområder</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../about-topic-areas/about-topic-areas.html">Om temaområder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../data-sharing/data-sharing.html">Datadeling</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../data-sharing/data-sharing.html">Om temaområdet <em>datadeling</em></a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../data-sharing/data-sharing-value-streams.html">Referansemodeller for datadeling</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../about-data-exchange/about-data-exchange.html">Datautveksling</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../about-data-exchange/about-data-exchange.html">Om temaområdet <em>datautveksling</em></a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../about-data-exchange/about-data-exchange-reference-architecture.html">Referansearkitektur for datautveksling</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../data-for-data-exchange/data-for-data-exchange.html">Begrepsapparat for data (datautveksling)</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../data-exchange-roles/data-exchange-roles.html">Roller involvert i datautveksling</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../about-data-exchange-patterns/about-data-exchange-patterns.html">Arkitekturmønstre for datautveksling</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../about-data-exchange-patterns/about-data-exchange-patterns.html">Om arkitekturmønstre for datautveksling</a>
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Basismønstre for datautveksling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../book-messaging/book-messaging.html">Forsendelse (one way push)</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../book-request-reply/book-request-reply.html">Forespørsel-svar</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../book-publish-subscribe/book-publish-subscribe.html">Publisering</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Løsningsbyggeklosser for bruk og gjenbruk</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Fellesløsninger</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Tekniske tjenester og API-er</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Sluttbrukertjenester</span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">Føringer og standarder</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Styring og organisering</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Initiativer</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../proposed-reference-architectures/proposed-reference-architecture-work.html">Innspill til prioritering av videre arbeid med referansearkitekturer</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../proposed-reference-architectures/følgebrev.html">Følgebrev</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../proposed-reference-architectures/situasjonsrapport.html">Situasjonsrapport</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../proposed-reference-architectures/strukturering-av-spørreskjema.html">Strukturering av spørreskjema</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../proposed-reference-architectures/forklaringer-til-spørsmålene.html">Forklaringer til spørsmålene</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../methods/methods.html">Metodikk for utvikling av nasjonal arkitektur</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../methods/reference-architecture-methods.html">Metodikk for utvikling av referansearkitekturer</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Se også</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../drafts/index.html">Utkast og innspill</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../knowledge/index.html">Arkitekturfaglig kunnskapsverksted</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Nasjonalt arkitekturverksted</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Arkitekturfaglig kunnskapsverksted</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../knowledge/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Nasjonalt arkitekturverksted</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Utkast og innspill</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../drafts/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Nasjonalt arkitekturverksted</a></li>
    <li><a href="event-streaming-concepts.html">Publisering av hendelser</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://gitlab.com/digdir/components/architecture-repository/edit/master/docs/architecture-landscape/topic-areas/data-exchange/patterns/publish-subscribe/modules/event-streaming/pages/event-streaming-concepts.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Publisering av hendelser</h1>
<div class="sect1">
<h2 id="_introduksjon"><a class="anchor" href="#_introduksjon"></a><a class="link" href="#_introduksjon">1. Introduksjon</a></h2>
<div class="sectionbody">
<div id="basiskonsept-publisering2" class="paragraph">
<p>Mønstre for publisering handler helt grunnleggende om at tilbydere publiserer datastrømmer, eller hendelsesstrømmer, uten å måtte vite hvem konsumentene er. Konsumentene kan i sin tur koble seg på disse hendelsestrømmene og ta rede på hva som skjer.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/Publisering%20av%20hendelser%20-%20basiskonsept.png" alt="Publisering av hendelser - basiskonsept image">
</div>
<div class="title">Figur 1. Publisering av hendelser - basiskonsept</div>
</div>
<div class="paragraph">
<p>Dette gir en form for løs kobling mellom aktørene som fremmer innovasjon og samhandling. Nye samhandlingsparter kan plukke opp hendelser og kople seg på i tjenesteproduksjonen. Forretningsprosessene behøver ikke være kartlagt og fastsatt i minste detalj på forhånd. Nye prosesser kan utvikles i dynamiske økosystemer. <em>Dette kan ses som et essensielt element i satsingen på sammenhengende tjenester og realisering av målsetninger om datadrevet økonomi og innovasjon; se f.eks.  <a href="https://www.regjeringen.no/no/tema/statlig-forvaltning/ikt-politikk/melding-om-datadrevet-okonomi-og-innovasjon/id2688376/">Stortingsmelding om datadrevet økonomi og innovasjon</a>.</em></p>
</div>
<div class="paragraph">
<p>Endringer i IT-systemene blir også enklere, fordi det vil være mindre avhengigheter til systemene hos andre virksomheter. En ønsker generelt å komme bort fra store monolittiske systemer som ikke er lagt opp til å samspille i en distribuert kontekst.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Info"></i>
</td>
<td class="content">
Løs kopling mellom IT-systemene er blant de de helt grunnleggende arkitekturprinsippene innen tjenesteorientert atrkitektur. Gjeldende arkitekturprinsipper fra Digitaliseringsdirektoratet per 2020 sier blant annet: <em>Ta hensyn til anerkjente designprinsipper for tjenesteorientert arkitektur, slik som løse koplinger, modularisering, standardiserte tjenestekontrakter med videre.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Det fokuseres her på mønstre som understøtter hendelsesdrevet arkitektur og tjenesteorientering, og det benyttes et begrepsapparat som gjenspeiler dette. Mønstre for publisering handler derfor her i hovedsak om publisering av data om hendelser, samt strømming av slike data. Andre former for publisering, slik som f.eks. publisering av API-er i en API-katalog, faller utenfor her.</p>
</div>
<div class="paragraph">
<p>Det finnes flere varianter av mønstrene, og disse egner seg til ulike formål. Utvikling av arkitekturer og fellesløsninger pågår både i Norge og internasjonalt, blant annet med komponenter fra EU. Det finnes også en rekke teknologier og produkter, deriblant mye som <em>open source</em>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tips"></i>
</td>
<td class="content">
I artikkelen  <a href="https://martinfowler.com/articles/201701-event-driven.html">What do you mean by “Event-Driven”?</a> (fra 2017), redegjør  Martin Fowler kort for noen av de mest aktuelle mønstrene for strømming av hendelser. Han peker her også på behovet for god veiledning.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dette er fremdeles for de fleste et vanskelig område å navigere i. Det finnes mange kilder til informasjon, men ingen enkelt, dekkende lærebok. Både vinkling og begrepsapparat fra ulike kilder er egnet til forvirring.</p>
</div>
<div class="paragraph">
<p>Ambisjonsnivået her er heller ikke  å gi en komplett innføring i alle aspekter. Beskrivelser og utvalg av mønstre vil være behovsdrevet og vil utvikles over tid.</p>
</div>
<div id="litteraturhenvisninger" class="sidebarblock">
<div class="content">
<div class="title">Noen litteraturhenvisninger</div>
<div class="paragraph">
<p>Det er skrevet mye om arkitekturmønstre for publisering, strømming og hendelsesdrevet arkitektur de siste årene, gjerne med ulike innfallsvinkler ut fra sammenhengen med arkitekturparadigmer som SOA og Microservices.</p>
</div>
<div class="paragraph">
<p>Noen utvalgte henvisninger:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://en.wikipedia.org/wiki/Event-driven_architecture">Wikipedia om Event-driven architecture</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Event-driven_SOA">Wikipedia om Event-driven SOA</a></p>
</li>
<li>
<p><a href="https://martinfowler.com/articles/201701-event-driven.html">Martin Fowler - What do you mean by “Event-Driven”?</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/w/index.php?title=Publish%E2%80%93subscribe_pattern&amp;oldid=950857039">Wikipedia om Publish-Subscribe</a></p>
</li>
<li>
<p><a href="https://doc.difi.no/nasjonal-arkitektur/kunnskap_/#event-collaboration">Event Collaboration</a></p>
</li>
<li>
<p><a href="https://www.sciencedirect.com/topics/computer-science/event-notification">Event Notification </a></p>
</li>
<li>
<p><a href="https://doc.difi.no/nasjonal-arkitektur/kunnskap_/#event-sourcing">Event Sourcing</a></p>
</li>
<li>
<p><a href="https://doc.difi.no/nasjonal-arkitektur/kunnskap_/#_pattern_cqrs_command_query_responsibility_segregation">CQRS</a></p>
</li>
<li>
<p><a href="https://mapr.com/blog/event-driven-microservices-patterns/">Event Driven Microservices Architecture Patterns and Examples</a></p>
</li>
<li>
<p><a href="https://www.confluent.io/blog/journey-to-event-driven-part-1-why-event-first-thinking-changes-everything/">Why Event-First Thinking Changes Everything</a></p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bruksområder-publisering-generelt"><a class="anchor" href="#bruksområder-publisering-generelt"></a><a class="link" href="#bruksområder-publisering-generelt">2. Bruksområder</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Eksempler på anvendelse av mønstre for publisering og konsumering av hendelsesstrømmer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Trigging av forretningsprosesser hos samhandlingsparter som deltar i dynamiske forretningsprosesser og tilpasset saksbehandling.</p>
</li>
<li>
<p>Replikering av data ved hendelsesbasert oppdatering av kopier og avledede datasett.</p>
</li>
<li>
<p>Logging av hendelsesrelaterte data for formål som arkivering og verifikasjon av etterlevelse.</p>
</li>
<li>
<p>Hendelsesbasert innhenting av data brukt til analyser og statistikk.</p>
</li>
<li>
<p>Strømming av IoT-data, enten periodisk (tidshendelse) eller ved terskeloverskridende endringer i måleverdier</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overskrift-grunnleggende-publisering"><a class="anchor" href="#overskrift-grunnleggende-publisering"></a><a class="link" href="#overskrift-grunnleggende-publisering">3. Konsepter for publisering og konsumering av hendelsesstrømmer</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="generisk-publisering"><a class="anchor" href="#generisk-publisering"></a><a class="link" href="#generisk-publisering">3.1. Basiskonsepter</a></h3>
<div class="sect3">
<h4 id="_aktørsamspill"><a class="anchor" href="#_aktørsamspill"></a><a class="link" href="#_aktørsamspill">3.1.1. Aktørsamspill</a></h4>
<div class="paragraph">
<p>Datatilbyder <span class="underline">publiserer</span> hendelsestrømmer som <span class="underline">konsumeres</span> av datakonsumenter. Tilsvarende kan en si at datatilbyders publiseringsløsning <span class="underline">skriver</span> notifikasjoner til hendelseslister etterhvert som hendelser skjer, etterfulgt av at datakonsumentene <span class="underline">leser</span> notifikasjoner gjennom sine løsninger for innhenting og mottak.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/Publisering%20av%20hendelser%20-%20grunnleggende%20konsept,%20med%20applikasjoner.png" alt="Publisering av hendelser - grunnleggende konsept" width="med applikasjoner image">
</div>
<div class="title">Figur 2. Publisering av hendelser - grunnleggende konsept, med applikasjoner</div>
</div>
<div class="paragraph">
<p>Legg merke til at den publiserte hendelseslisten her er en del av tilbyders løsning og ansvar.</p>
</div>
<div class="paragraph">
<p>I praksis kan også både datatilbyder og datakonsument velge å benytte en ekstern tjenesteleverandør for å formidle hendelsesdata. I så fall kan ekstern tjenesteleverandørs løsninger og tjenester anses som del av tilbyders eller konsuments løsninger og tjenester på lik linje med interne leverandører (og behøver ikke vises som egen part).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Advarsel"></i>
</td>
<td class="content">
Det faller utenfor omfanget her å gå inn på tilfeller der  ekstern tjenesteleverandør opptrer som  mellomledd på en måte som gjør det nødvendig å se på juridiske forhold eller løsninger på tvers av partene.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="grunnleggende-begreper"><a class="anchor" href="#grunnleggende-begreper"></a><a class="link" href="#grunnleggende-begreper">3.1.2. Begrepsapparat</a></h4>
<div class="paragraph">
<p>Grunnleggende begreper og sammenhenger er vist i følgende modell.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/Grunnleggende%20begreper%20for%20publisering%20av%20hendelser.png" alt="Grunnleggende begreper for publisering av hendelser image">
</div>
<div class="title">Figur 3. Grunnleggende begreper for publisering av hendelser</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Hendelser</em> er det som skjer i den virkelige i verden, i en konstant strøm av endrede data, eller <em>hendelsesstrømmer</em>.</p>
</li>
</ul>
</div>
<div id="subjekt-definisjon" class="ulist">
<ul>
<li>
<p><em>Subjekt</em> er hvem eller hva hendelsen omhandler, slik dette er å oppfatte i den aktuelle konteksten. Dette kan f.eks. være et fysisk objekt (eks. bil), en person, en virksomhet eller et konsept (eks. politikk). Det kan også være en samling av underordnede subjekter, slik som f.eks. en befolkningsgruppe eller alle virksomheter som har et navn som begynner på A.</p>
</li>
<li>
<p>Assosiert med hver hendelse finnes et <em>datagrunnlag</em> som tilsvarer tilstanden før hendelsen inntraff. I bakkant av hendelsen finnes tilsvarende  et <em>oppdatert datagrunnlag</em>.</p>
</li>
</ul>
</div>
<div id="definisjon-hendelsesrelaterte-data" class="ulist">
<ul>
<li>
<p>I tilknytning til hver hendelse finnes <em>Hendelsesrelaterte data</em>. Dette kan være små eller store datasett som beskriver datagrunnlaget og aktuelle endringer. Nærmere om begreper og tekniske løsninger for dette gis i tilknytning til de ulike arkitekturmønstrene, med ulike måter å representere og oppdatere datagrunnlaget på, på tvers av tilbyder og konsument.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>En <em>notifikasjon</em> informerer om at en hendelse har inntruffet og kan inneholde hele eller deler av det totale settet av aktuelle <em>hendelsesrelaterte data</em>, enten direkte eller gjennom lenke til hvor datasettet finnes (eventuelt en kombinasjon).</p>
</li>
<li>
<p>Notifikasjoner samles og publiseres av tilbyder gjennom  <em>hendelseslister</em>.</p>
</li>
<li>
<p>En og samme hendelse kan være representert gjennom flere notifikasjoner som hver beskriver hendelsen på ulike måter for ulike formål og ulike målgrupper; som publisert gjennom ulike hendelseslister.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="notifikasjonsinnhold-generisk"><a class="anchor" href="#notifikasjonsinnhold-generisk"></a><a class="link" href="#notifikasjonsinnhold-generisk">3.1.3. Innhold i notifikasjoner</a></h4>
<div class="paragraph">
<p>Begrepsapparatet bygger på <a href="#grunnleggende-begreper">det grunnleggende begrepsapparatet for publisering av hendelsesstrømmer</a>.</p>
</div>
<div class="paragraph">
<p>En modell som konkretiserer notifikasjonsinnholdet er vist i figuren nedenfor. Her er det også angitt relasjonene til hendelsesrelaterte data, noe som kan være et langt større datasett enn det som utveksles i notifikasjoner mellom tilbyder og konsument.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/Notifikasjonsinnhold.png" alt="Notifikasjonsinnhold image">
</div>
<div class="title">Figur 4. Notifikasjonsinnhold</div>
</div>
<div class="paragraph">
<p>Forklaring til figuren over:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>En notifikasjon inneholder som minimum en <em>identifikator for notifikasjonen</em>. Denne må være gyldig på tvers av tilbyder og konsument. Tilbyder må holde rede på sammenhengen mellom notifikasjon og assosierte, <a href="#definisjon-hendelsesrelaterte-data">hendelsesrelaterte data</a>.</p>
</li>
<li>
<p>Hvilke notifikasjonsdata som forøvrig er relevante,  avhenger av hendelsestype og eventuell innholdsminimering.</p>
<div class="ulist">
<ul>
<li>
<p><em>Hendelsestype</em> identifiserer typen hendelse overfor konsument, som grunnlag  for filtrering og videre behandling.</p>
</li>
<li>
<p>Sekvensinformasjon kan gis ved å peke på foregående notifikasjon for samme subjekt. Tidsstempel med tilstrekkelig oppløsning kan også angi sekvens, men gir  ikke generelt en like direkte og treffsikker identifisering av foregående notifikasjon. <em>Merk: Løpende sekvensnummer er også mulig å benytte, men er ikke vist her.</em></p>
</li>
<li>
<p>Subjekt for hendelse: Se <a href="#subjekt-definisjon">definisjon av subjekt</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_innhenting_av_notifikasjoner_gjennom_spørring_mot_hendelseslister"><a class="anchor" href="#_innhenting_av_notifikasjoner_gjennom_spørring_mot_hendelseslister"></a><a class="link" href="#_innhenting_av_notifikasjoner_gjennom_spørring_mot_hendelseslister">3.1.4. Innhenting av notifikasjoner gjennom spørring mot hendelseslister</a></h4>
<div class="paragraph">
<p>Pullbasert innhenting av notifikasjoner skjer gjennom at konsumenten forespør notifikasjoner fra tilbyder, etterfulgt av at forespurte notifikasjoner leveres. Dette kan være en enkelt notifikasjon eller flere i rekke. Illustrasjon (sekvensdiagram):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/Spørring%20mot%20hendelseslister%20-%20basisflyt.png" alt="Spørring mot hendelseslister - basisflyt image">
</div>
<div class="title">Figur 5. Spørring mot hendelseslister - basisflyt</div>
</div>
<div class="paragraph">
<p>Forespørsler gjøres mot tilbyders spørretjeneste, som vist i følgende diagram.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/Tilbyders%20spørretjeneste%20mot%20hendelsesliste.png" alt="Tilbyders spørretjeneste mot hendelsesliste image">
</div>
<div class="title">Figur 6. Tilbyders spørretjeneste mot hendelsesliste</div>
</div>
<div class="paragraph">
<p>Tilbyders spørretjeneste  mot hendelseslister må støtte ulike måter å lese ut aktuelle hendelser på, slik som:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Spørringer for å hente ut filtrerte utvalg av notifikasjoner og, ved behov, minimere datainnhold i hver enkelt notifikasjon.</p>
</li>
<li>
<p>Avspilling av notifikasjoner innen angitt tidsrom.</p>
</li>
<li>
<p>Avspilling av seneste notifikasjoner, f.eks etter en gitt identifikator.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_innhenting_av_supplerende_hendelsesrelaterte_data"><a class="anchor" href="#_innhenting_av_supplerende_hendelsesrelaterte_data"></a><a class="link" href="#_innhenting_av_supplerende_hendelsesrelaterte_data">3.1.5. Innhenting av supplerende hendelsesrelaterte data</a></h4>
<div class="paragraph">
<p>For notifikasjoner som ikke gir et tilstrekkelig sett av <em>hendelsesrelaterte data</em> for konsumentens formål, må datakonsumenten selv ta initiativ til å innhente <em>supplerende hendelsesrelaterte data</em>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Det er uproblematisk å sende med en ny måleverdi for et termometer, mens det kan være mindre ønskelig å distribuere komplette kopier av større og distribuerte datasett. Hensyn til dataminimering (personvern eller andre hesnyn) spiller også en rolle i slike vurderinger.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Den typiske prosessen er illustrert i følgende sekvensdiagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/Spørring%20mot%20hendelseslister%20-%20med%20innhenting%20av%20supplerende%20data.png" alt="Spørring mot hendelseslister - med innhenting av supplerende data image">
</div>
<div class="title">Figur 7. Spørring mot hendelseslister - med innhenting av supplerende data</div>
</div>
<div class="paragraph">
<p>I <em>forespørsel om supplerende hendelsesrelaterte data</em> må det kunne identifiseres hvilke data som ønskes. Tilbyder kan gi ulike opsjoner for dette. En mulighet er at <em>identifikator for notifikasjonen</em> entydig identifiserer aktuelle datasett. En annen mulighet er f.eks. spørring etter etter spesifikke informasjonselementer for et angitt subjekt.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tips"></i>
</td>
<td class="content">
Det bør sikres at <em>hendelsesrelaterte data</em> forblir identifiserbare og tilgjengelige over tid. En god måte å gjøre dette på er gjennom globalt unike identifikatorer i kombinasjon med en mekanisme for datavirtualisering.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Info"></i>
</td>
<td class="content">
Selve innhentingen av <em>supplerende hendelsesrelaterte data</em> dekkes av eOppslag referansearkitektur.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_avanserte_konsepter"><a class="anchor" href="#_avanserte_konsepter"></a><a class="link" href="#_avanserte_konsepter">3.2. Avanserte konsepter</a></h3>
<div class="sect3">
<h4 id="generisk-publish-subscribe"><a class="anchor" href="#generisk-publish-subscribe"></a><a class="link" href="#generisk-publish-subscribe">3.2.1. Abonnementsbasert publisering</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Info"></i>
</td>
<td class="content">
Dette konseptet tilsvarer det som i litteraturen tradisjonelt omtales som <em>publish-subscribe</em>; se f.eks. <a href="https://en.wikipedia.org/w/index.php?title=Publish%E2%80%93subscribe_pattern&amp;oldid=950857039">wikipedia om publish-subscribe pattern</a> for en enkel beskrivelse av dette.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Her introduseres støtte for å tegne abonnementer for formål og behov som:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Støtte for strenge sanntidskrav. Unngå behov for å polle hendelseslistene for endringer og i stedet få abonnerte notifikasjoner levert fortløpende (pushbasert levering).</p>
</li>
<li>
<p>Velg mellom opsjoner for å få mottak av notifikasjoner til ønsket teknisk grensesnitt (f.eks. kall av API vs. levering til meldingkø).</p>
</li>
<li>
<p>SLA-avtaler, f.eks. avtale om akseptable tidsforsinkelser før levering av notifikasjoner.</p>
</li>
<li>
<p>Abonnementsbasert betaling. f.eks. ut fra valg mellom ulike, volumbaserte prispakker som tilbys, eller f.eks. volumuavhengig fastpris.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Følgende figur illustrerer det forretningsmessige koneptet for abonnement på hendelsesstrømmer.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/Publisering%20av%20hendelser%20-%20basiskonsept%20med%20abonnement.png" alt="Publisering av hendelser - basiskonsept med abonnement image">
</div>
<div class="title">Figur 8. Publisering av hendelser - basiskonsept med abonnement</div>
</div>
<div class="paragraph">
<p>Registrering av abonnement gjøres typisk mot en selvbetjeningsløsning for dette hos datatilbyder. Datatilbyder vil deretter sende notifikasjoner fortløpende og pushbasert til konsumentens mottaksløsning som avtalt.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/Pushbasert%20levering%20av%20notifikasjoner%20til%20abonnenter.png" alt="Pushbasert levering av notifikasjoner til abonnenter image">
</div>
<div class="title">Figur 9. Pushbasert levering av notifikasjoner til abonnenter</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Analogi til mediehus:</div>
<div class="ulist">
<ul>
<li>
<p>Mediehus (tilbyder) publiserer nyheter  (hendelser)  via  nyhetskanaler (hendelsesstrømmer) til et konsumentmarked der konsumentene ikke nødvendigvis er kjent på forhånd.</p>
</li>
<li>
<p>Konsumenter kan kople seg på for å lese nyheter på tilfeldig basis, f.eks. en løssalgsavis.</p>
</li>
<li>
<p>Konsumenter kan eventuelt tegne abonnementer for å få levert nyhetene "på døra" (f.eks. til en innboks).</p>
</li>
<li>
<p>Konsumenter kan også tegne abonnementer for å få et utvalg av nyhetene (innholdsfilter.)</p>
</li>
<li>
<p>Tilbyder kan ta betalt for innhold og tjenester, eller det kan være gratis.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="filtrering-og-minimering"><a class="anchor" href="#filtrering-og-minimering"></a><a class="link" href="#filtrering-og-minimering">3.2.2. Filtrering og minimering av hendelseslister og notifikasjoner</a></h4>
<div class="paragraph">
<p>Filtrering og minimering av hendelseslister og notifikasjoner handler om:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Filtrering av hendelseslister slik at en får det ønskede utvalget av subjekter og hendelser, f.eks. salg av leiligheter til under 2 millioner kroner i  din bydel. Dette handler ikke om å gjøre innhentingen stykkevis og delt. Det er normalt viktig å sørge for at den filtrerte hendelseslisten gir komplett historikk for formålet.</p>
</li>
<li>
<p>Minimering av innholdet i notifikasjoner, slik at konsumenten unngår å motta eller få tilgang til mer informasjon enn det som er interessant for konsumenten eller det has hjemmel for ut fra personvernhensyn.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Dette kan løses på ulike måter, herunder:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Tilbyder tilbyr ulike hendelseslister, der det i utgangspunktet er gjort et utvalg fra det komplette utvalget innen tilbyders domene, basert på metadata og kriterier som tema eller konfidensialitet for hver hendelsesliste.</p>
</li>
<li>
<p>Tilbyder filtrerer innen hver hendelsesliste ut fra konsumentens spesifikasjon /spørring.</p>
</li>
<li>
<p>Tilbyder minimerer innholdet i hver notifikasjon ut fra konsumentens spesifikasjon /spørring.</p>
</li>
<li>
<p>Konsumenten ignorerer irrelevante notifikasjoner ved å filtrere innlesingen på konsumentsiden eller forkaste notifikasjoner etter innlesing.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>På veien fra tilbyder til konsument vil hendelseslister og notifikasjoner på denne måten endre innhold. Det er de samme hendelsene som gjelder, men nye datasett. Det kan være nyttig å skille mellom tilbyders publiserte notifikasjoner, utvekslede notifikasjoner (tilpasset for konsument av tilbyder) og de notifikasjonene som er relevante for konsument og tas videre til  prosessering. En kan tilsvarende se på serier av f.eks. utvekslede notifikasjoner som en utvekslet hendelsesliste. Dette begrepsapparatet er oppsummert i følgende modell.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/Filtrering%20og%20minimering%20av%20hendelseslister%20og%20notifikasjoner.png" alt="Filtrering og minimering av hendelseslister og notifikasjoner på tvers av tilbyder og konsument image">
</div>
<div class="title">Figur 10. Filtrering og minimering av hendelseslister og notifikasjoner på tvers av tilbyder og konsument</div>
</div>
</div>
<div class="sect3">
<h4 id="utledning-av-subjekttilstand"><a class="anchor" href="#utledning-av-subjekttilstand"></a><a class="link" href="#utledning-av-subjekttilstand">3.2.3. Tilstand som resultat av hendelser</a></h4>
<div class="paragraph">
<p>Et subjekts tilstand kan beskrives i form av et øyeblikksbilde eller som en serie endringer ut fra et tidligere øyeblikksbilde. En notifikasjon inneholder tilsvarende enten et øyeblikksbilde av subjektet eller data om hendelsen som beskriver en inkrementell endring.</p>
</div>
<div class="paragraph">
<p>Eksempel: Anta at termometeravlesninger rapporteres som daglige endringer siden forrige avlesning. For å finne dagens temperatur, må det være et kjent startpunkt (øyeblikksbilde).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tips"></i>
</td>
<td class="content">
En kan tenke på notifikasjoner  som transaksjoner i et regskap som gjøres opp med jevne mellomrom. Subjekttilstanden tilsvarer saldo, og ny saldo kan enkelt regnes ut ved å legge sammen alle transaksjonene siden forrige dokumenterte oppgjør. En kan også gå hele veien tilbake til oppstart, som i dette tilfellet uten videre er et kjent utgangspunkt (nullsaldo).
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>Kontakt: nasjonalarkitektur@digdir.no, eventuelt erik.hagen@digdir.no, tlf. +47 90631013.</p>
  <p>Digitaliseringsirektoratet, 2020.</p>
</footer><script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
